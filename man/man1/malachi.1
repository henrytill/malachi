.TH MALACHI 1
.SH NAME
malachi \- full-text search indexer for content-addressable systems
.SH SYNOPSIS
.B malachi
[
.B -vdct
]
.SH DESCRIPTION
.I Malachi
is a full-text search indexer daemon for content-addressable systems. It creates searchable indexes of merkle tree content while leveraging immutable hashing for efficient caching and incremental updates.
.PP
If no arguments are given,
.I malachi
starts as a daemon and listens for indexing commands via a named pipe.
.PP
The daemon uses SQLite with FTS5 for full-text search indexing and supports pluggable content filters for various document types.
.PP
The optional flags are:
.TP
.B -v
Print version information.
.TP
.B -d
Enable debug output when running the daemon.
.TP
.B -c
Print configuration paths (config, data, cache, and runtime directories).
.TP
.B -t
Run tests. If followed by a test name, run only that test.
.SH DAEMON OPERATION
The daemon creates a named pipe at
.I runtimedir/command
for receiving indexing commands and maintains status files under
.I runtimedir/roots/
that mirror the filesystem structure of indexed content trees.
.PP
The runtime directory location is platform-dependent: on Unixen it follows XDG conventions, checking
.I $XDG_RUNTIME_DIR/malachi,
.I /run/user/$UID/malachi,
and
.I /tmp/malachi-$UID.
On macOS it uses
.I $TMPDIR/malachi
or
.I /tmp/malachi.
.PP
Commands use ASCII separator format with positional fields:
.PP
.RS
added\\x1F/path/to/root\\x1Froothash\\x1Ffile.txt\\x1Fleafhash\\x1E
.RE
.PP
Supported operations are
.I added,
.I changed,
.I removed,
and
.I shutdown.
.SH COMPANION TOOLS
The
.B git-crawl
script in the
.I bin/
directory provides Git repository support, detecting changes and generating appropriate indexing commands for the daemon. Other content-addressable systems can be supported through similar client scripts.
.SH SOURCE
.B src/cmd/malachi
